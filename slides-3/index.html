<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>Dag 3</title>
        <link href="assets/css/show.css" type="text/css" rel="stylesheet" />
        <link href="assets/css/prettify.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript" src="assets/js/jquery.min.js"></script>
        <script type="text/javascript" src="assets/js/show.js"></script>
        <script type="text/javascript" src="assets/js/prettify/prettify.js"></script>
        <script type="text/javascript" src="assets/js/prettify/lang-apollo.js"></script><script type="text/javascript" src="assets/js/prettify/lang-css.js"></script><script type="text/javascript" src="assets/js/prettify/lang-hs.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lisp.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lua.js"></script><script type="text/javascript" src="assets/js/prettify/lang-ml.js"></script><script type="text/javascript" src="assets/js/prettify/lang-proto.js"></script><script type="text/javascript" src="assets/js/prettify/lang-scala.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vb.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vhdl.js"></script><script type="text/javascript" src="assets/js/prettify/lang-wiki.js"></script><script type="text/javascript" src="assets/js/prettify/lang-yaml.js"></script>
      <script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
      </head>
      <body>
        <div id="slides">
          <div id="reel">
            <div class="content" id="slide-0">
       <div class="container"><h1>pattern matching</h1><ul><li>“switch på steroider”
</li><li>destructuring &amp; matching
</li><li>vanlig blant funksjonelle språk som haskell, erlang, ml osv
</li></ul></div>
      </div><div class="content" id="slide-1">
       <div class="container"><h1>krav</h1><ul><li>gitt en <code>List[List[Int]]</code>
</li><li>når det første element er er en liste hvor første element er er 1, 2 eller 3, return det tallet
</li><li>når det andre elementer i lista er en liste, returner det andre elementet i den listen hvis det eksisterer
</li><li>ellers returner 0
</li></ul></div>
      </div><div class="content" id="slide-2">
       <div class="container"><pre><code class="prettyprint lang-java">public int f(List&lt;List&lt;Integer&gt;&gt; l){
  if(l != null){
    if(l.size() &gt;= 1){
      List&lt;Integer&gt; l2 = l.get(0);
      if(l2 != null &amp;&amp; l2.size() &gt;= 1){
        Integer i = l2.get(0);
        if(i == 1 || i == 2 || i == 3)
          return i;
      }
    }
    if(l.size() &gt;= 2){
      List&lt;Integer&gt; l2 = l.get(1);
      if(l2 != null &amp;&amp; l2.size() &gt;= 2)
        return l2.get(1);      
    }
  }
  return 0;
}
</code></pre></div>
      </div><div class="content" id="slide-3">
       <div class="container"><pre><code class="prettyprint lang-scala">def f(l:List[List[Int]]) = l match {
  case List(List(x @ (1 | 2 | 3), _*), _*) =&gt; x
  case List(_, List(_, x, _),_*) =&gt; x
  case _ =&gt; 0
}
</code></pre></div>
      </div><div class="content" id="slide-4">
       <div class="container"><h2>wildcard</h2><pre><code class="prettyprint lang-scala">x match {
  case _ =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-5">
       <div class="container"><h2>variable</h2><pre><code class="prettyprint lang-scala">x match {
  case y =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-6">
       <div class="container"><h2>typed</h2><pre><code class="prettyprint lang-scala">x match {
  case _:Foo =&gt;
  case a:C =&gt;
  case b:p.C =&gt;
  case c:T#C =&gt;
  case d:Singleton.type =&gt; 
  case e:(A with B with C) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-7">
       <div class="container"><h2>binding</h2><pre><code class="prettyprint lang-scala">x match {
  case y @ _ =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-8">
       <div class="container"><h2>literal</h2><pre><code class="prettyprint lang-scala">x match {
  case &quot;hello&quot; =&gt;
  case 5 =&gt;
  case true =&gt;
  case 'A' =&gt;
  case 5.5 =&gt;
}

</code></pre></div>
      </div><div class="content" id="slide-9">
       <div class="container"><h2>@switch</h2><pre><code class="prettyprint lang-scala">(x: @switch) match {
  case 1 =&gt;
  case 2 =&gt;
  case 3 =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-10">
       <div class="container"><h2>@switch</h2><pre><code class="prettyprint lang-scala">(x: @switch) match {
  case 1 =&gt;
  case 2 =&gt;
  case &quot;3&quot; =&gt;
}

// error: could not emit switch for @switch annotated match
</code></pre></div>
      </div><div class="content" id="slide-11">
       <div class="container"><h2>stable identifier ?</h2><pre><code class="prettyprint lang-scala">val hello = &quot;hello&quot;
&quot;world&quot; match {
  case hello =&gt; // matcher
}
</code></pre></div>
      </div><div class="content" id="slide-12">
       <div class="container"><h2>stable identifier</h2><pre><code class="prettyprint lang-scala">val Hello = &quot;hello&quot;
&quot;world&quot; match {
  case Hello =&gt; // matcher ikke
}
</code></pre></div>
      </div><div class="content" id="slide-13">
       <div class="container"><h2>stable identifier</h2><pre><code class="prettyprint lang-scala">def f(x:Int, y:Int) = x match {
  case `y` =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-14">
       <div class="container"><h2>constructor</h2><pre><code class="prettyprint lang-scala">case class Foo(a:String, b:Int)

x match {
  case Foo(aString, anInt) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-15">
       <div class="container"><h2>constructor</h2><pre><code class="prettyprint lang-scala">case class Foo(a:String, b:Int)

x match {
  case Foo(&quot;Hello&quot;, 5) =&gt;
  case Foo(aString, anInt) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-16">
       <div class="container"><h2>Algebraiske Data Typer</h2><pre><code class="prettyprint lang-scala">sealed trait Tree
case class Branch(l:Tree, r:Tree) extends Tree
case class Leaf(v:Int) extends Tree

def sum(t:Tree):Int = t match {
  case Branch(l, r) =&gt; sum(l) + sum(r)
  case Leaf(v) =&gt; v
}

val tree = Branch(
  Branch(Leaf(1), Leaf(2)),
  Branch(Leaf(3), Leaf(4)))
sum(tree)
</code></pre></div>
      </div><div class="content" id="slide-17">
       <div class="container"><h2>tuple</h2><pre><code class="prettyprint lang-scala">x match {
  case (first, second) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-18">
       <div class="container"><h2>tuple</h2><pre><code class="prettyprint lang-scala">x match {
  case (first, second, third) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-19">
       <div class="container"><h2>sequences</h2><pre><code class="prettyprint lang-scala">x match {
  case List(a, b) =&gt;
  case List(a, b, c, _*) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-20">
       <div class="container"><h2>sequences</h2><pre><code class="prettyprint lang-scala">x match {
  case List(a, b) =&gt;
  case List(a, b, c, d @ _*) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-21">
       <div class="container"><h2>extractors</h2><pre><code class="prettyprint lang-scala">def unapply(a:A):Boolean

def unapply(a:A):Option[B]

def unapplySeq(a:A):Option[Seq[B]]
</code></pre></div>
      </div><div class="content" id="slide-22">
       <div class="container"><h2>unapply</h2><pre><code class="prettyprint lang-scala">object Empty {
  def unapply(a:String):Boolean = a.trim.size == 0
}

x match {
  case Empty() =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-23">
       <div class="container"><h2>unapply</h2><pre><code class="prettyprint lang-scala">object Even {
  def unapply(a:Int):Option[Int] =
    if(a % 2 == 0) Some(a) else None
}

x match {
  case Even(even) =&gt; 
}
</code></pre></div>
      </div><div class="content" id="slide-24">
       <div class="container"><pre><code class="prettyprint lang-java">class Name{
  String first; String last;
  public Name(first:String, last:String){
    this.first = first; this.last = last;	
  }
}
</code></pre><pre><code class="prettyprint lang-scala">object FirstLast {
  def unapply(name:Name):Option[(String, String)] = 
    Some(name.first, name.last)
}

(new Name(&quot;scala&quot;, &quot;kurs&quot;)) match {
  case FirstLast(first, last) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-25">
       <div class="container"><h2>unapplySeq</h2><pre><code class="prettyprint lang-scala">object Csv {
  def unapplySeq(s:String) = Some(s.split(&quot;,&quot;).toSeq)
}

&quot;1,2,3&quot; match {
  case Csv(a, b, c) =&gt; a+&quot;-&quot;+b+&quot;-&quot;+c
}
</code></pre></div>
      </div><div class="content" id="slide-26">
       <div class="container"><h2>extractor tree</h2><pre><code class="prettyprint lang-scala">sealed trait Tree
object Branch {
  private class Impl(val l:Tree, r:Tree) extends Tree
  def apply(l:Tree, r:Tree):Tree = new Impl(l, r)
  def unapply(t:Tree) = t match {
    case i:Impl =&gt; Some(i.l, i.r)
    case _ =&gt; None	
  }
}
object Leaf {
  private class Impl(val v:Int) extends Tree
  def apply(v:Int):Tree = new Impl(v)
  def unapply(t:Tree) = t match {
    case i:Impl =&gt; Some(i.v)
    case _ =&gt; None	
  }
}
</code></pre></div>
      </div><div class="content" id="slide-27">
       <div class="container"><pre><code class="prettyprint lang-scala">def sum(tree:Tree):Int = tree match {
  case Branch(left, right) =&gt; sum(left) + sum(right)
  case Leaf(value) =&gt; value
}
</code></pre></div>
      </div><div class="content" id="slide-28">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">case class XX(a:String, b:Int)

x match {
  case a XX b =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-29">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">case class ::[A](head:A, tail:List[A]) extends List[A] {
  def ::[B &gt;: A](b:B):List[B] = ::(b, this)
}

(1 :: 2 :: 3 :: Nil) match {
  case a :: b :: c :: Nil =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-30">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">case class ::[A](head:A, tail:List[A]) extends List[A] {
  def ::[B &gt;: A](b:B):List[B] = ::(b, this)
}

(1 :: 2 :: 3 :: Nil) match {
  case ::(1, ::(2, ::(3, Nil))) =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-31">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">object -&gt; {
  def unapply[A, B](ab:(A, B)):Option[(A, B)] =
	Some(ab)
}

(1 -&gt; 2) match {
  case a -&gt; b =&gt; 
}

(1 -&gt; 2 -&gt; 3) match {
  case a -&gt; b -&gt; c =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-32">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">case class EX(l:List[String], num:Int, s:String)

x match {
  case l EX (num, s) =&gt; 
}
</code></pre></div>
      </div><div class="content" id="slide-33">
       <div class="container"><h2>infix</h2><pre><code class="prettyprint lang-scala">case class EX(l:List[String], num:Int, s:String)

x match {
  case a :: b :: c EX (num, s) =&gt; 
}
</code></pre></div>
      </div><div class="content" id="slide-34">
       <div class="container"><h2>alternatives</h2><pre><code class="prettyprint lang-scala">x match {
  case 1 | 2 =&gt;
  case _:Foo | _:Bar =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-35">
       <div class="container"><h2>alternatives</h2><pre><code class="prettyprint lang-scala">try {
  // throw something
} catch {
  case e @ (_:ExA | _:ExB) =&gt; // multicatch
}
</code></pre></div>
      </div><div class="content" id="slide-36">
       <div class="container"><h2>xml</h2><pre><code class="prettyprint lang-scala">&lt;foo&gt;bar&lt;/foo&gt; match {
  case &lt;foo&gt;{what}&lt;/foo&gt; =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-37">
       <div class="container"><h2>guards</h2><pre><code class="prettyprint lang-scala">x match {
  case y if y &gt; 2 =&gt;
}
</code></pre></div>
      </div><div class="content" id="slide-38">
       <div class="container"><h2>partial functions</h2><pre><code class="prettyprint lang-scala">val pos:PartialFunction[Int, String] = {
  case n if n &gt; 0 =&gt; n.toString
}

pos.isDefinedAt(5) // true
pos.isDefinedAt(-1) // false

pos(5)  // &quot;5&quot;
pos(-1) // java.util.NoSuchElementException
</code></pre></div>
      </div><div class="content" id="slide-39">
       <div class="container"><h2>partial functions</h2><pre><code class="prettyprint lang-scala">val pos:PartialFunction[Int, String] = {
  case n if n &gt; 0 =&gt; n.toString
}

val notPos:PartialFunction[Int, String] = {
  case n if n &lt;= 0 =&gt; &quot;Not positive&quot;
}

val all = pos orElse notPos

for(i &lt;- -5 to 5)
  println(all(i))
</code></pre></div>
      </div><div class="content" id="slide-40">
       <div class="container"><pre><code class="prettyprint lang-scala">val Num = &quot;(\\d+)&quot;.r
List(&quot;123&quot;, &quot;abc&quot;, &quot;321&quot;).collect{
  case Num(num) =&gt; num.toInt
}
// List(123, 321)
</code></pre></div>
      </div><div class="content" id="slide-41">
       <div class="container"><h2>functions</h2><pre><code class="prettyprint lang-scala">List(-2, -1, 0, 1, 2).foldLeft(0){
  case (a, e) =&gt; if e &lt; 0 =&gt; a
  case (a, e) =&gt; a + e
}
</code></pre></div>
      </div><div class="content" id="slide-42">
       <div class="container"><h2>assignment</h2><pre><code class="prettyprint lang-scala">val (minors, adults) = people.partition(_.age &lt; 18)

val Email = &quot;(.+)@(.+)&quot;.r
val EMail(name, domain) = &quot;foo@bar.com&quot;
</code></pre></div>
      </div><div class="content" id="slide-43">
       <div class="container"><h2>for-comprehensions</h2><pre><code class="prettyprint lang-scala">object Even {
  def unapply(i:Int) = 
    if(i % 2 == 0) Some(i) else None
}

for{
  Even(number) &lt;- List(1, 2, 3, 4)
} yield number
</code></pre></div>
      </div><div class="content" id="slide-44">
       <div class="container"><h2>erasure</h2><pre><code class="prettyprint lang-scala">val list:List[Any] = List(1, 2, 3)

list match {
  case x:List[String] =&gt; &quot;Strings&quot; // matcher
  case x:List[Int] =&gt; &quot;Ints&quot;
}
</code></pre></div>
      </div><div class="content" id="slide-45">
       <div class="container"><h2>#1133</h2><p><code>Exception in thread &quot;main&quot; java.lang.Error: 
ch.epfl.lamp.fjbg.JCod$OffsetTooBigException: offset to big to fit in 16 bits: 55087</code>
</p></div>
      </div><div class="content" id="slide-46">
       <div class="container"><h2>don’t</h2><pre><code class="prettyprint lang-scala">val a:Option[Int] = ...

a match {
  case Some(i) =&gt; Some(i * 2)
  case _ =&gt; None
}
</code></pre></div>
      </div><div class="content" id="slide-47">
       <div class="container"><h2>do</h2><pre><code class="prettyprint lang-scala">val a:Option[Int] = ...

a.map(i =&gt; i * 2)
</code></pre></div>
      </div><div class="content" id="slide-48">
       <div class="container"><h2>don’t</h2><pre><code class="prettyprint lang-scala">val a:Option[String] = ...
val b:Option[String] = ...

(a, b) match {
  case (Some(hello), Some(world)) =&gt; Some(hello + &quot; &quot; + world)
  case _ =&gt; None
}
</code></pre></div>
      </div><div class="content" id="slide-49">
       <div class="container"><h2>do</h2><pre><code class="prettyprint lang-scala">val a:Option[String] = ...
val b:Option[String] = ...

for{
  hello &lt;- a
  world &lt;- b
} yield hello + &quot; &quot; + world
</code></pre></div>
      </div><div class="content" id="slide-50">
       <div class="container"><h1>Oppgavetid :-)</h1><p>Skriv ditt eget webrammeverk! (thats right)
</p><p><a href="https://github.com/arktekk/scala-kurs-oppgaver/tree/master/webframework" >webframework</a>
</p></div>
      </div><div class="content" id="slide-51">
       <div class="container"><h1>self types</h1><pre><code class="prettyprint lang-scala">trait A {
  this:B =&gt;

  def callB(){ bMethod() }
}

trait B {
  def bMethod(){ println(&quot;I am B!&quot;)}
}
</code></pre></div>
      </div><div class="content" id="slide-52">
       <div class="container"><pre><code class="prettyprint lang-scala">new A with B{} // OK

new A{}

error: illegal inheritance;
 self-type java.lang.Object with A does not conform to A's selftype A with B
              new A{}
                  ^
</code></pre></div>
      </div><div class="content" id="slide-53">
       <div class="container"><h1>path-dependent types</h1><pre><code class="prettyprint lang-scala">trait A {
  class Param
  val param = new Param

  def hi(param:Param){ println(&quot;Hi Param&quot;) }
}

object X1 extends A
object X2 extends A

X1.hi(X1.param)
X2.hi(X2.param)

X1.hi(X2.param)

error: type mismatch;
 found   : X2.Param
 required: X1.Param
              X1.hi(X2.param)
                       ^
</code></pre></div>
      </div><div class="content" id="slide-54">
       <div class="container"><h1>cake pattern</h1><pre><code class="prettyprint lang-scala">trait A { def sayHi() }

trait AComponent { this:BComponent =&gt;
  def a:A
  class AImpl(name:String) extends A { 
	def sayHi(){ 
	  println(b.hi + &quot; &quot; + name) 
	}
  }
}

trait BComponent {
  def b:B = new B{}
  trait B{ def hi = &quot;Hi&quot; }
}

object ProdApp extends AComponent with BComponent {
  val a = new AImpl(&quot;Prod&quot;)
}
</code></pre></div>
      </div>
          </div>
        </div>
        
      </body>
    </html>